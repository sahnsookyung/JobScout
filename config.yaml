database:
  # DEFAULT only. In Docker, this is overridden by DATABASE_URL env var.
  url: "postgresql://user:password@localhost:5432/jobscout"

web:
  # Web dashboard server configuration
  host: "0.0.0.0"
  port: 8080  # Changed from 5000 to avoid conflicts

jobspy:
  # DEFAULT only. In Docker, this is overridden by JOBSPY_URL env var.
  url: "http://localhost:8000" 

etl:
  llm:
    # DEFAULT only. In Docker, this is overridden by ETL_LLM_BASE_URL env var.
    base_url: "http://localhost:11434/v1" # Use local installation of ollama over docker virtualization. Docker can't use GPU on Apple Silicon at time of writing. 
    api_key: "ollama" # Dummy key for local Ollama
    
    # Extraction
    extraction_url: "" # Not used for Ollama/OpenAI
    extraction_type: "ollama" # Use "openai", "ollama" or "mock"
    extraction_model: "qwen3:14b"
    
    # Embedding
    embedding_model: "qwen3-embedding:4b"
    embedding_dimensions: 1024 # Embedding Dimension: Up to 2560, supports user-defined output dimensions ranging from 32 to 2560 (https://huggingface.co/Qwen/Qwen3-Embedding-4B)
    
    extraction_labels:
      - "programming_language"
      - "framework"
      - "tool"
      - "platform"
      - "skill"
      - "experience_years"
      - "education_degree"
      - "certification"
      - "responsibility"
      - "benefit"

matching:
  enabled: true
  # Mode: requirements_only (default) or with_preferences
  mode: "requirements_only"
  
  # Resume file path (relative to working directory or absolute)
  resume_file: "resume.json"
  
  # Preferences file (only used if mode == "with_preferences")
  # preferences_file: "preferences.json"
  
  # Invalidation settings
  invalidate_on_job_change: true
  invalidate_on_resume_change: true
  recalculate_existing: false  # If true, recalculate matches even if they exist
  
  # Stage 1: Matcher Service (Vector Retrieval)
  matcher:
    enabled: true
    similarity_threshold: 0.5
    top_k_requirements: 3
    # embedding_model: null  # Uses ETL embedding model if not specified
    embedding_dimensions: 1024
    batch_size: 100
    include_job_level_matching: true  # Also match at job summary level
  
  # Stage 2: Scorer Service (Rule-based Scoring)
  scorer:
    enabled: true
    # Scoring weights
    weight_required: 0.7
    weight_preferred: 0.3
    
    # Penalty amounts
    penalty_missing_required: 15.0
    penalty_location_mismatch: 10.0
    penalty_seniority_mismatch: 10.0
    penalty_compensation_mismatch: 10.0
    
    # User preferences for scoring
    wants_remote: true
    # min_salary: 50000
    # max_salary: 150000
    # target_seniority: "mid"  # junior|mid|senior

notifications:
  # Set to true to enable notifications (disabled by default)
  enabled: true
  
  # Base URL for links in notifications (e.g., to view matches in dashboard)
  base_url: "http://localhost:8080"  # Uses web.port from above
  
  # Unique user identifier for notifications
  # user_id: "your_user_id"
  
  # Only notify for matches above this score (0-100)
  min_score_threshold: 70.0
  
  # Notification triggers
  notify_on_new_match: true        # When a high-scoring match is found
  notify_on_batch_complete: true   # Summary after each matching batch
  
  # Custom notification channels - load external channel implementations
  # See docs/NOTIFICATIONS.md for details on creating custom channels
  # custom_channels:
  #   - name: "my_webhook"
  #     module: "my_package.channels"      # Python module path
  #     class: "CustomWebhookChannel"      # Class name in module
  
  # Notification channels (configure at least one)
  # Recipients are read from environment variables if not specified here
  channels:
    # email:
    #   enabled: true
    #   recipient: "your-email@example.com"  # Optional: overrides EMAIL env var
    #   # Requires: SMTP_SERVER, SMTP_PORT, SMTP_USERNAME, SMTP_PASSWORD
    
    discord:
      enabled: true
      recipient: ""  # Not used, set DISCORD_WEBHOOK_URL env var instead
      # Requires: DISCORD_WEBHOOK_URL
    
    # telegram:
    #   enabled: true
    #   recipient: "@your_channel_or_chat_id"  # Chat ID or @channelusername
    #   # Requires: TELEGRAM_BOT_TOKEN
    
    # webhook:
    #   enabled: true
    #   recipient: "https://your-webhook.com/endpoint"
    #   # No env vars required - URL specified here or in metadata
    
    # in_app:
    #   enabled: true
    #   # Logs only - for future dashboard integration
  
  # Deduplication prevents sending the same notification twice
  deduplication_enabled: true
  resend_interval_hours: 24
  
  # Async processing via Redis Queue
  use_async_queue: true
  redis_url: "redis://localhost:6379/0"  # Optional: overrides REDIS_URL env var

schedule:
  interval_seconds: 3600  # Run every hour

scrapers:
  - site_type: ["tokyodev"]
    search_term: ""
    results_wanted: 1
    options:
      japanese_requirements: ["none"]
      seniorities: ["intern", "junior", "intermediate"]
      
  - site_type: ["japandev"]
    search_term: ""
    results_wanted: 1
    options:
      japanese_levels: ["japanese_level_not_required"]
      seniorities: ["seniority_level_junior", "seniority_level_mid_level"]
      applicant_locations: ["candidate_location_anywhere"]

  - site_type: ["indeed"]
    search_term: "software engineer"
    location: "Tokyo"
    country: "Japan"
    results_wanted: 1
    hours_old: 168 # 24 * 7
  
  - site_type: ["glassdoor"]
    search_term: "software engineer"
    location: "Tokyo"
    results_wanted: 1
    hours_old: 168
    request_timeout: 300 # 5 mins

  - site_type: ["linkedin"]
    search_term: "software engineer"
    location: "Tokyo"
    results_wanted: 1
    hours_old: 168
    linkedin_fetch_description: True
