database:
  # PostgreSQL connection (can be overridden by DATABASE_URL env var)
  url: "postgresql://user:password@localhost:5432/jobscout"

web:
  # Web dashboard server configuration
  host: "0.0.0.0"
  port: 8080  # Changed from 5000 to avoid conflicts

jobspy:
  # JobSpy scraping service URL (can be overridden by JOBSPY_URL env var)
  url: "http://localhost:8000" 

etl:
  # Resume processing configuration
  resume:
    # Resume file path (relative or absolute)
    resume_file: "resume.json"
    # force_re_extraction: false  # Uncomment to force re-extraction every time
  llm:
    # Ollama base URL (can be overridden by ETL_LLM_BASE_URL env var)
    base_url: "http://localhost:11434/v1"
    api_key: "ollama"  # Dummy key for local Ollama
    
    # Extraction
    extraction_url: "" # Not used for Ollama/OpenAI
    extraction_type: "ollama" # Use "openai", "ollama" or "mock"
    extraction_model: "qwen3:14b"
    extraction_temperature: 0.5  # Temperature for extraction. 0.0 = "deterministic", but the results are not great. Research suggests we need a higher temperature than 0.
    
    # Embedding
    embedding_model: "qwen3-embedding:4b"
    embedding_dimensions: 1024 # Embedding Dimension: Up to 2560, supports user-defined output dimensions ranging from 32 to 2560 (https://huggingface.co/Qwen/Qwen3-Embedding-4B)
    
    extraction_labels:
      - "programming_language"
      - "framework"
      - "tool"
      - "platform"
      - "skill"
      - "experience_years"
      - "education_degree"
      - "certification"
      - "responsibility"
      - "benefit"

matching:
  enabled: true
  # Mode: requirements_only (default).
  mode: "requirements_only"
   
  # User wants file (optional): Add your job preferences in natural language
  # One want per line, e.g., "I want remote work", "Looking for Python roles"
  # Enables semantic matching between your wants and job facets (remote_flexibility, compensation, etc.)
  # user_wants_file: "wants.txt"
  
  # Invalidation settings
  invalidate_on_job_change: true
  invalidate_on_resume_change: true
  recalculate_existing: true  # If true, recalculate matches even if they exist. Very important to set to false for performance improvements (job, resume, scoring parameters being the same means the score should be the same).
  
  # Stage 1: Matcher Service (Vector Retrieval)
  matcher:
    enabled: true
    similarity_threshold: 0.5
    batch_size: 100
  
  # Stage 2: Scorer Service (Rule-based Scoring)
  scorer:
    enabled: true

    # Scoring weights (Fit: "can do the job", Want: "matches what I want")
    # overall_score = fit_weight * fit_score + want_weight * want_score
    fit_weight: 0.70
    want_weight: 0.30

    # Facet weights for Want score calculation
    facet_weights:
      remote_flexibility: 0.15
      compensation: 0.20
      learning_growth: 0.15
      company_culture: 0.15
      work_life_balance: 0.15
      tech_stack: 0.10
      visa_sponsorship: 0.10

    # Coverage weights (used in Fit score calculation)
    weight_required: 0.7
    weight_preferred: 0.3

    # Capability penalty amounts (Fit score only)
    penalty_missing_required: 15.0
    penalty_seniority_mismatch: 10.0
    penalty_compensation_mismatch: 10.0
    
    # User preferences (for display-time hard filters)
    wants_remote: true
    min_salary: null
    target_seniority: null


notifications:
  # Set to true to enable notifications (disabled by default)
  enabled: true

  # Base URL for links in notifications (e.g., to view matches in dashboard)
  base_url: "http://localhost:8080"  # Uses web.port from above

  # Unique user identifier for notifications
  # user_id: "your_user_id"

  # Only notify for matches above this score (0-100)
  min_score_threshold: 60.0

  # Priority thresholds for notifications (score 0-100)
  priority:
    high: 80  # Score >= 80 is HIGH priority
    normal: 60  # Score >= 60 is NORMAL priority
    low: 0  # Score < 60 is LOW priority
  
  # Notification triggers
  notify_on_new_match: true        # When a high-scoring match is found
  notify_on_batch_complete: true   # Summary after each matching batch
  
  # Custom notification channels - load external channel implementations
  # See docs/NOTIFICATIONS.md for details on creating custom channels
  # custom_channels:
  #   - name: "my_webhook"
  #     module: "my_package.channels"      # Python module path
  #     class: "CustomWebhookChannel"      # Class name in module
  
  # Notification channels (configure at least one)
  # Recipients are read from environment variables if not specified here
  channels:
    # email:
    #   enabled: true
    #   recipient: "your-email@example.com"  # Optional: overrides EMAIL env var
    #   # Requires: SMTP_SERVER, SMTP_PORT, SMTP_USERNAME, SMTP_PASSWORD
    
    discord:
      enabled: true
      recipient: ""  # Not used, set DISCORD_WEBHOOK_URL env var instead
      # Requires: DISCORD_WEBHOOK_URL
    
    # telegram:
    #   enabled: true
    #   recipient: "@your_channel_or_chat_id"  # Chat ID or @channelusername
    #   # Requires: TELEGRAM_BOT_TOKEN
    
    # webhook:
    #   enabled: true
    #   recipient: "https://your-webhook.com/endpoint"
    #   # No env vars required - URL specified here or in metadata
    
    # in_app:
    #   enabled: true
    #   # Logs only - for future dashboard integration
  
  # Deduplication prevents sending the same notification twice
  deduplication_enabled: true
  resend_interval_hours: 24
  
  # Async processing via Redis Queue
  use_async_queue: true
  # redis_url: "redis://localhost:6379/0"  # Optional: overrides REDIS_URL env var
  
  # Rate limiting: max seconds to wait when rate limited (5 minutes)
  rate_limit_max_wait_seconds: 300

schedule:
  interval_seconds: 3600  # Run every hour

scrapers:
  - site_type: ["tokyodev"]
    search_term: ""
    results_wanted: 5
    options:
      japanese_requirements: ["none"]
      seniorities: ["intern", "junior", "intermediate"]
      
  - site_type: ["japandev"]
    search_term: ""
    results_wanted: 5
    options:
      japanese_levels: ["japanese_level_not_required"]
      seniorities: ["seniority_level_junior", "seniority_level_mid_level"]
      applicant_locations: ["candidate_location_anywhere"]

  - site_type: ["indeed"]
    search_term: "software engineer"
    location: "Tokyo"
    country: "Japan"
    results_wanted: 5
    hours_old: 168 # 24 * 7
  
  - site_type: ["glassdoor"]
    search_term: "software engineer"
    location: "Tokyo"
    results_wanted: 5
    hours_old: 168
    request_timeout: 300 # 5 mins

  - site_type: ["linkedin"]
    search_term: "software engineer"
    location: "Tokyo"
    results_wanted: 5
    hours_old: 168
    linkedin_fetch_description: true
